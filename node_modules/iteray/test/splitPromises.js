'use strict'

const assert = require('assert')
const I = require('../lib')

it('splits an AsyncIterable in two with values and reasons', function () {
  const asyncQueue = I.AsyncQueue()

  I.forEach(I.push(asyncQueue), [
    Promise.resolve({done: false, value: 1}),
    Promise.reject('one'),
    Promise.resolve({done: false, value: 2}),
    Promise.reject('two'),
    Promise.resolve({done: true})
  ])

  const split = I.splitPromises(asyncQueue)

  return Promise.all(I.map(I.to(Array), [split.values, split.reasons]))
    .then((arrays) => {
      assert.deepEqual(arrays[0], [1, 2])
      assert.deepEqual(arrays[1], ['one', 'two'])
    })
})
