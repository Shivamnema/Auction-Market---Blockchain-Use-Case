'use strict'

const assert = require('assert')
const I = require('../lib')

it('Iterable', function () {
  const array = [1, 2, 3]
  const [left, right] = I.split(I.to('Iterable', array))
  assert.deepEqual(I.to(Array, left), array)
  assert.deepEqual(I.to(Array, right), array)
})

it('AsyncIterable', function () {
  const input = [1, 2, 3]

  return Promise.all(I.map(I.to(Array), I.split(I.to('AsyncIterable', input))))
    .then((outputs) => {
      assert.deepEqual(outputs[0], input)
      assert.deepEqual(outputs[0], outputs[1])
    })
})

it('provides an interface convenient for pipes', function () {
  const input = [1, 2, 3]
  let right

  const left = I.split((split) => {
    right = split
  }, I.to('AsyncIterable', input))

  return Promise.all(I.map(I.to(Array), [left, right])).then((outputs) => {
    assert.deepEqual(outputs[0], input)
    assert.deepEqual(outputs[0], outputs[1])
  })
})
