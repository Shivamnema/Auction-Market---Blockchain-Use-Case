'use strict'

const assert = require('assert')
const I = require('../lib')

const elements = [1, 2, 3]

it('Array', function () {
  const accumulator = []
  const forEached = I.forEach(I.push(accumulator), elements)
  assert.deepEqual(forEached, elements)
  assert.deepEqual(accumulator, elements)
})

it('Iterable', function () {
  const accumulator = []
  const forEached = I.forEach(I.push(accumulator), I.to('Iterable', elements))
  assert.deepEqual(I.to(Array, forEached), elements)
  assert.deepEqual(accumulator, elements)
})

it('AsyncIterable', function () {
  const accumulator = []

  const forEached = I.forEach(
    I.push(accumulator),
    I.to('AsyncIterable', elements)
  )

  return I.to(Array, forEached).then((array) => {
    assert.deepEqual(array, elements)
    assert.deepEqual(accumulator, elements)
  })
})

it('Object', function () {
  const object = {a: 1, b: 2, c: 3}
  const accumulator = []

  const forEached = I.forEach((key, value) =>
    I.push(accumulator, [key, value]), object
  )

  assert.deepEqual(forEached, object)
  assert.deepEqual(accumulator, [['a', 1], ['b', 2], ['c', 3]])
})
