'use strict'

const assert = require('assert')
const I = require('../lib')

it('exerts a constant pull on an AsyncIterable', function () {
  const asyncQueue = I.AsyncQueue()
  assert(!asyncQueue.isPulling())
  I.sink(asyncQueue)
  assert(asyncQueue.isPulling())
  asyncQueue.push(Promise.resolve({done: false, value: null}))

  setImmediate(() => {
    assert(asyncQueue.isPulling())
  })
})
